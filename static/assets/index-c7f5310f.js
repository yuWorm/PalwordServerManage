var q=Object.defineProperty,N=Object.defineProperties;var j=Object.getOwnPropertyDescriptors;var y=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var V=(r,e,t)=>e in r?q(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,d=(r,e)=>{for(var t in e||(e={}))B.call(e,t)&&V(r,t,e[t]);if(y)for(var t of y(e))z.call(e,t)&&V(r,t,e[t]);return r},b=(r,e)=>N(r,j(e));import{aT as k,aU as A,aV as D,aW as O,j as E,S as F,R as G,o as C,d as U,w as s,c as a,f as i,aX as v,U as J,t as w,e as $}from"./index-5d6b5a6a.js";import{a as m,V as g}from"./VRow-1f85bbf5.js";import{V as _,b as S}from"./VCard-df5c671c.js";class M{constructor(e,t,n={}){this.config=n,this.callbacks=t,this.url=e,this.controller=new k}post(e){const t=d({},this.config);return t.method="POST",t.body=JSON.stringify(e),this.request(t)}get(){const e=d({},this.config);return e.method="GET",this.request(e)}cancle(){this.controller.abort(),this.controller=new k}request(e){const t=A();if(!t){D(401,"登录已过期，请重新登录！");return}e.headers=b(d({},e==null?void 0:e.headers),{"Content-Type":"application/json",Authorization:"Bearer "+t}),e.signal=this.controller.signal;const n=this;return fetch("/api"+this.url,e).then(o=>{var u,l;return(u=n.callbacks)!=null&&u.onFirst&&((l=n.callbacks)==null||l.onFirst(o)),o}).then(o=>{const u=o.body.getReader();return new ReadableStream({start(l){return p();function p(){return u.read().then(({done:T,value:f})=>{var h,x;if(T){l.close();return}const R=O.decode(f);return(h=n.callbacks)!=null&&h.onValue&&((x=n.callbacks)==null||x.onValue(R)),l.enqueue(f),p()})}}})}).then(o=>new Response(o)).catch(o=>{console.error("这里的异常",o)})}}const c=E({memoryUsed:0,memoryTotal:0,memoryUsedPercent:0,cpuUsedPercent:0,cpuCount:0,networks:{eth0:{rx_bytes:0,rx_packets:0,rx_errors:0,rx_dropped:0,tx_bytes:0,tx_packets:0,tx_errors:0,tx_dropped:0}}}),P=new M("/server/info",{onValue:r=>{const e=JSON.parse(r);c.value=e}});function W(){P.get()}function X(){P.cancle()}const H={__name:"SystemMonitor",setup(r){return F(()=>{W()}),G(()=>{X()}),(e,t)=>(C(),U(g,null,{default:s(()=>[a(m,{cols:"12",md:"4",sm:"12"},{default:s(()=>[a(_,{title:`CPU使用情况(${i(c).cpuCount})`,class:"position-relative"},{default:s(()=>[a(S,{flex:"","justify-center":"","flex-center":""},{default:s(()=>[a(v,{rotate:360,size:150,width:10,"model-value":i(c).cpuUsedPercent,color:"teal"},{default:s(()=>[J(w(i(c).cpuUsedPercent)+" % ",1)]),_:1},8,["model-value"])]),_:1})]),_:1},8,["title"])]),_:1}),a(m,{cols:"12",md:"4",sm:"12"},{default:s(()=>[a(_,{title:"内存使用情况",class:"position-relative"},{default:s(()=>[a(S,{flex:"","justify-center":"","flex-center":""},{default:s(()=>[a(v,{rotate:360,size:150,width:10,"model-value":i(c).memoryUsedPercent,color:"teal"},{default:s(()=>[$("span",null,w(i(c).memoryUsedPercent)+" % ",1)]),_:1},8,["model-value"])]),_:1})]),_:1})]),_:1}),a(m,{cols:"12",md:"4",sm:"12"},{default:s(()=>[a(_,{title:"网络使用情况",class:"position-relative"})]),_:1})]),_:1}))}},Y={__name:"index",setup(r){return(e,t)=>(C(),U(g,{class:"match-height"},{default:s(()=>[a(m,{col:"12"},{default:s(()=>[a(H)]),_:1})]),_:1}))}};export{Y as default};
