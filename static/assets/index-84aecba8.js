var S=Object.defineProperty;var b=Object.getOwnPropertySymbols;var C=Object.prototype.hasOwnProperty,D=Object.prototype.propertyIsEnumerable;var P=(s,l,e)=>l in s?S(s,l,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[l]=e,g=(s,l)=>{for(var e in l||(l={}))C.call(l,e)&&P(s,e,l[e]);if(b)for(var e of b(l))D.call(l,e)&&P(s,e,l[e]);return s};var w=(s,l,e)=>new Promise((v,m)=>{var p=n=>{try{_(e.next(n))}catch(o){m(o)}},f=n=>{try{_(e.throw(n))}catch(o){m(o)}},_=n=>n.done?v(n.value):Promise.resolve(n.value).then(p,f);_((e=e.apply(s,l)).next())});import{aA as M,j as y,Q as T,l as H,y as B,o as j,z as A,c as a,w as r,aD as F,aY as i,a2 as U,f as V,V as N,U as O,e as R}from"./index-5d6b5a6a.js";import{g as k}from"./common-9e7c6e84.js";import{V as q,b as z}from"./VCard-df5c671c.js";import{V as E}from"./VForm-45b97a38.js";import{V as c,a as d}from"./VRow-1f85bbf5.js";const x={save:s=>M.put("/server/interval",s),get:()=>M.get("/server/interval")},I=R("p",{"ml-10":""},"保存后会直接更新定时任务，前提是启用的对应的定时任务",-1),X={__name:"index",setup(s){const l=y({auto_restart_palworld_server:!1,auto_restart_palworld_server_time:"2024-01-29T17:00:33.043428",auto_backup:!1,auto_backup_interval:0,update_player:!1,update_player_interval:20,auto_update_palworld_server:!1,auto_update_palworld_interval:"2024-01-30T11:47:05.421607"}),e=T({restartPalworldHour:1,restartPalworldMinutes:1,updatePalworldHour:1,updatePalworldMinutes:1}),v=k(1,24),m=k(1,60),p=y(!1);function f(o,t){var u=new Date;return u.setHours(o),u.setMinutes(t),u.toISOString()}function _(){return w(this,null,function*(){p.value=!0;try{const o=g({},l.value);yield x.save(o)}catch(o){console.error(o)}p.value=!1})}H(()=>[e.restartPalworldHour,e.restartPalworldMinutes],(o,t)=>{l.value.auto_restart_palworld_server_time=f(o[0],o[1])},{deep:!0,immediate:!0}),H(()=>[e.updatePalworldHour,e.updatePalworldMinutes],(o,t)=>{l.value.auto_update_palworld_interval=f(o[0],o[1])},{deep:!0,immediate:!0});function n(){return w(this,null,function*(){p.value=!0;try{const o=yield x.get();l.value=o;const t=new Date(l.value.auto_restart_palworld_server_time);e.restartPalworldHour=t.getHours(),e.restartPalworldMinutes=t.getMinutes();const u=new Date(l.value.auto_update_palworld_interval);e.updatePalworldHour=u.getHours(),e.updatePalworldMinutes=u.getMinutes()}catch(o){console.log(error)}p.value=!1})}return B(()=>{n()}),(o,t)=>(j(),A("div",null,[a(q,{title:"定时设置"},{default:r(()=>[I,a(z,null,{default:r(()=>[a(E,{onSubmit:F(()=>{},["prevent"])},{default:r(()=>[a(c,null,{default:r(()=>[a(d,{cols:"12"},{default:r(()=>[a(i,{modelValue:l.value.update_player,"onUpdate:modelValue":t[0]||(t[0]=u=>l.value.update_player=u),items:[{title:"启用",value:!0},{title:"关闭",value:!1}],label:"定时更新在线玩家",variant:"outlined",placeholder:"是否开启自动更新在线玩家"},null,8,["modelValue"])]),_:1}),a(d,{cols:"12"},{default:r(()=>[a(U,{modelValue:l.value.update_player_interval,"onUpdate:modelValue":t[1]||(t[1]=u=>l.value.update_player_interval=u),label:"更新在线玩家时间间隔(秒)",placeholder:"更新在线玩家时间间隔(秒)",type:"number"},null,8,["modelValue"])]),_:1}),a(d,{cols:"12"},{default:r(()=>[a(i,{modelValue:l.value.auto_backup,"onUpdate:modelValue":t[2]||(t[2]=u=>l.value.auto_backup=u),items:[{title:"启用",value:!0},{title:"关闭",value:!1}],label:"定时备份游戏数据",variant:"outlined",placeholder:"是否开启定时备份游戏数据"},null,8,["modelValue"])]),_:1}),a(d,{cols:"12"},{default:r(()=>[a(U,{modelValue:l.value.auto_backup_interval,"onUpdate:modelValue":t[3]||(t[3]=u=>l.value.auto_backup_interval=u),label:"备份间隔(小时)",placeholder:"备份时间间隔(秒)",type:"number"},null,8,["modelValue"])]),_:1}),a(d,{cols:"12"},{default:r(()=>[a(i,{modelValue:l.value.auto_update_palworld_server,"onUpdate:modelValue":t[4]||(t[4]=u=>l.value.auto_update_palworld_server=u),items:[{title:"启用",value:!0},{title:"关闭",value:!1}],label:"定时更新游戏服务程序",variant:"outlined",placeholder:"是否开启定时更新游戏服务程序"},null,8,["modelValue"])]),_:1}),a(d,{cols:"12"},{default:r(()=>[a(c,null,{default:r(()=>[a(d,{cols:"6"},{default:r(()=>[a(i,{modelValue:e.updatePalworldHour,"onUpdate:modelValue":t[5]||(t[5]=u=>e.updatePalworldHour=u),items:V(v),label:"时刻"},null,8,["modelValue","items"])]),_:1}),a(d,{cols:"6"},{default:r(()=>[a(i,{modelValue:e.updatePalworldMinutes,"onUpdate:modelValue":t[6]||(t[6]=u=>e.updatePalworldMinutes=u),items:V(m),label:"分钟"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),a(d,{cols:"12"},{default:r(()=>[a(i,{modelValue:l.value.auto_restart_palworld_server,"onUpdate:modelValue":t[7]||(t[7]=u=>l.value.auto_restart_palworld_server=u),items:[{title:"启用",value:!0},{title:"关闭",value:!1}],label:"定时重启",variant:"outlined",placeholder:"定时重启"},null,8,["modelValue"])]),_:1}),a(d,{cols:"12"},{default:r(()=>[a(c,null,{default:r(()=>[a(d,{cols:"6"},{default:r(()=>[a(i,{modelValue:e.restartPalworldHour,"onUpdate:modelValue":t[8]||(t[8]=u=>e.restartPalworldHour=u),items:V(v),label:"时刻"},null,8,["modelValue","items"])]),_:1}),a(d,{cols:"6"},{default:r(()=>[a(i,{modelValue:e.restartPalworldMinutes,"onUpdate:modelValue":t[9]||(t[9]=u=>e.restartPalworldMinutes=u),items:V(m),label:"分钟"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),a(d,{"offset-md":"",cols:"12","grid-items-center":"","justify-center":"",flex:""},{default:r(()=>[a(N,{type:"submit","prepend-icon":"mdi-content-save",loading:p.value,onClick:_},{default:r(()=>[O(" 保存 ")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]))}};export{X as default};
